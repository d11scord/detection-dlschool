# Object detection

*руководитель проекта: Илья Захаркин (Сколтех, ФИВТ МФТИ) | @ilyazakharkin*

---

Работающее демо можно опробовать [здесь](http://34.105.245.162/).

### Запуск на локалхосте

Установка зависимостей

```
cd detection-dlschool
pip install -r requirements.txt
```

Запуск сервера

```
python -m flask run
```

или

```
python app.py
```

### Выбор фреймворка/библиотеки для использования детектора

Я выбрала `torchvision.models.detection.fasterrcnn_resnet50_fpn`.

### Выбор фреймворка/библиотеки для разработки веб/мобильного демо и его оформление

`Flask, Flask-Bootstrap`

### Запуск модели/сервера и тестирование демо

Первые пробы сервера и его запуска были сделаны по [туториалу 1](https://pytorch.org/tutorials/intermediate/flask_rest_api_tutorial.html) и [туториалу 2](https://github.com/avinassh/pytorch-flask-api-heroku).

При деплое возникли проблемы, модель оказалась очень требовательна к ресурсам и во время предсказания может занимать около 1.5Гб оперативной памяти. На локальной машине всё работает нормально, но Хероку вылетал на предсказывании из-за нехватки RAM (поэтому произошел переезд на Google Cloud с большей вычислительной мощностью).
 
Демо работает хорошо только со стоковыми изображениями (то есть с белым фоном и без размытий). На обычных фотографиях не предсказываются боксы (очень маленький скор, около 0.1). Возможно, это связано не с очень правильной предобработкой.

*Например:*

+ Неплохо

![group_of_people](./test_pictures/group_of_people.png)

+ Пойдёт

![group_of_people](./test_pictures/children.png)

+ Вообще ничего

![group_of_people](./test_pictures/cute_doge.png)
